LEOMPA部分来自文件资料，部分是自己建立的相关函数